modified from https://github.com/cloudlena/s3manager/tree/900f6881404092500256b70871ede7d882726527
